# 3. Use tools such as htop to observe system behavior. Make an effort to understand what each column, metric, and option represents and how it is useful in day-to-day troubleshooting.

## 1. What `htop` is (and why it‚Äôs better than `top`)

`htop` is an **interactive process viewer**.

Compared to `top`, it:

- Shows **per-CPU usage**
- Uses **colors** to explain *what* is using CPU/RAM
- Allows **mouse + keyboard interaction**
- Lets you **kill, renice, sort, and filter processes live**

Install it if needed:

```bash
sudo apt install htop
```

Run:

```bash
htop
```

---

## 2. Top section ‚Äì System meters (VERY IMPORTANT)

### CPU bars (per core)

Each bar represents **one CPU core**.

**Colors inside CPU bar:**

- üü© **Green** ‚Äì User processes (apps, programs)
- üü• **Red** ‚Äì Kernel / system processes
- üü¶ **Blue** ‚Äì Low-priority (nice) processes
- üü™ **Purple** ‚Äì Virtualization (KVM, containers)

**How this helps:**

- One core at 100% ‚Üí single-threaded bottleneck
- All cores high ‚Üí system-wide load (compilation, malware, runaway job)

---

### Memory (Mem)

Example:

```
Mem  3.2G / 15.5G

```

**Colors:**

- üü© Green ‚Äì Memory actually used by programs
- üü¶ Blue ‚Äì Buffers
- üü® Yellow ‚Äì Cache (can be freed if needed)

üëâ **Important Linux concept**

> Cached memory is NOT a problem. Linux uses RAM aggressively to speed up disk I/O.
> 

**Real troubleshooting:**

- High green + swapping ‚Üí memory pressure
- High yellow only ‚Üí system is healthy

---

### Swap

Example:

```
Swp  0K / 8.0G

```

**If swap is used heavily:**

- System may feel slow
- Indicates insufficient RAM or memory leak

---

### Load Average (top-right)

Example:

```
Load average: 0.45 0.60 1.10

```

Represents **average runnable processes**:

- 1 min / 5 min / 15 min

**Rule of thumb:**

- Load ‚âà number of CPU cores ‚Üí normal
- Load >> cores ‚Üí CPU congestion

---

## 3. Process list ‚Äì Column-by-column (CRITICAL)

### PID

Process ID

Used when killing or tracing a process.

---

### USER

User owning the process.

- Helps find **which user started a runaway process**

---

### PRI (Priority)

Kernel scheduling priority.

- Lower number = higher priority

---

### NI (Nice value)

User-defined priority:

- Range: `20` (highest) ‚Üí `19` (lowest)

**Real use:**

- Lower priority of heavy background tasks

---

### VIRT (Virtual Memory)

Total virtual memory used:

- RAM + swapped + mapped files

‚ö†Ô∏è **Often misleading**

Large `VIRT` does NOT mean real memory usage.

---

### RES (Resident Memory)

**Actual RAM used** by process

üëâ **Most important memory column**

---

### SHR (Shared Memory)

Memory shared with other processes (libraries).

---

### S (State)

- `R` ‚Äì Running
- `S` ‚Äì Sleeping (normal)
- `D` ‚Äì Uninterruptible sleep (I/O wait ‚ö†Ô∏è)
- `Z` ‚Äì Zombie (buggy parent)
- `T` ‚Äì Stopped

**Troubleshooting tip:**

- Many `D` processes ‚Üí disk or filesystem issue

---

### %CPU

CPU usage of process.

**Key insight:**

- Can exceed 100% on multicore systems
- 400% = using 4 cores fully

---

### %MEM

Percentage of total RAM used.

---

### TIME+

Total CPU time consumed.

- Long-running hogs show up here

---

### Command

The actual command started.

- Press `c` to toggle full command path

---

## 4. Essential keyboard shortcuts (daily use)

### Sorting

- `F6` ‚Üí Choose sort column
    - Sort by `%CPU` ‚Üí CPU hogs
    - Sort by `RES` ‚Üí Memory hogs

---

### Kill a process

- Select process
- `F9` ‚Üí Send signal
    - `SIGTERM` (15) ‚Üí Graceful stop
    - `SIGKILL` (9) ‚Üí Force kill

---

### Change priority (renice)

- Select process
- `F7` ‚Üí Increase priority (lower nice)
- `F8` ‚Üí Decrease priority (higher nice)

---

### Filter processes

- `/` ‚Üí Search by name
- Useful for finding:
    - `chrome`
    - `gnome-shell`
    - `mysql`

---

### Tree view

- `F5` ‚Üí Parent/child relationship
- Useful to identify **which process spawned others**

---

### Toggle threads

- `H` ‚Üí Show threads
- Important for Java, browsers, databases

---

## 5. Real-world troubleshooting examples

### üêå System is slow

1. Sort by `%CPU`
2. Check:
    - Single core maxed ‚Üí poorly optimized app
    - All cores maxed ‚Üí heavy workload
3. Renice or kill offender

---

### üí• RAM full, system lagging

1. Check `RES` and `%MEM`
2. Ignore cache (yellow)
3. Look for:
    - Browser tabs
    - Java apps
    - Memory leaks

---

### üíΩ Disk seems stuck

1. Look for process state `D`
2. Indicates:
    - Slow disk
    - Bad filesystem
    - Network filesystem hang

---

### üëª Zombie processes

- `Z` state
- Usually harmless unless many
- Parent process bug

---

## 6. Configuration tips (one-time setup)

Press `F2` ‚Üí Setup:

Recommended:

- Enable **Detailed CPU time**
- Show **CPU usage bar**
- Enable **Highlight running processes**
- Add **IO_READ / IO_WRITE** columns

This turns `htop` into a full diagnostic tool.

---

## 7. When to use `htop` vs other tools

| Tool | Best for |
| --- | --- |
| htop | Live system troubleshooting |
| free -h | Quick memory check |
| vmstat | Memory + CPU pressure |
| iotop | Disk I/O issues |
| journalctl | Crash/root cause analysis |

---

### Final takeaway

`htop` answers **three critical questions instantly**:

1. *What is slow?* ‚Üí `%CPU`, load
2. *Who is eating RAM?* ‚Üí `RES`
3. *Can I safely stop it?* ‚Üí `Command`, `USER`, `TIME+`